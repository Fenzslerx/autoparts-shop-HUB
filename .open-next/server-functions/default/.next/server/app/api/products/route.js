(()=>{var e={};e.id=684,e.ids=[684],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8560:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f});var n={};r.r(n),r.d(n,{GET:()=>l,POST:()=>p});var a=r(9303),o=r(8716),s=r(3131),i=r(1615),c=r(3423),u=r(3895);async function l(){let e=await (0,c.A5)();return Response.json(e)}async function p(e){let t=(await (0,i.cookies)()).get("admin_auth");if(!t||"true"!==t.value)return Response.json({error:"Unauthorized"},{status:401});try{let t=await e.json(),r=await (0,c.yP)(t);return await (0,u.Ls)("create",{id:r.id,name:r.name}),Response.json(r)}catch(e){return Response.json({error:"Failed to create product"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"C:\\Users\\Field\\Desktop\\MAVARIX\\src\\app\\api\\products\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:y}=d,h="/api/products/route";function m(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}},3358:(e,t,r)=>{"use strict";let n,a,o,s,i;var c=Object.create,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,d=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,f=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let a of p(t))g.call(e,a)||a===r||u(e,a,{get:()=>t[a],enumerable:!(n=l(t,a))||n.enumerable});return e},y=(n={"../../node_modules/dedent-tabs/dist/dedent-tabs.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){for(var t="string"==typeof e?[e]:e.raw,r="",n=0;n<t.length;n++)if(r+=t[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{"),n<(1>=arguments.length?0:arguments.length-1)){var a=r.substring(r.lastIndexOf("\n")+1).match(/^(\s*)\S?/);r+=((1>n+1||arguments.length<=n+1?void 0:arguments[n+1])+"").replace(/\n/g,"\n"+a[1])}var o=r.split("\n"),s=null;if(o.forEach(function(e){var t=e.match(/^(\s+)\S+/);if(t){var r=t[1].length;s=s?(0,Math.min)(s,r):r}}),null!==s){var i=s;r=o.map(function(e){return" "===e[0]||"	"===e[0]?e.slice(i):e}).join("\n")}return r.trim().replace(/\\n/g,"\n")}}},function(){return a||(0,n[p(n)[0]])((a={exports:{}}).exports,a),a.exports}),h={};((e,t)=>{for(var r in t)u(e,r,{get:t[r],enumerable:!0})})(h,{getOptionalRequestContext:()=>x,getRequestContext:()=>O}),e.exports=f(u({},"__esModule",{value:!0}),h),r(8769);var m=(i=null!=(o=y())?c(d(o)):{},f(!s&&o&&o.__esModule?i:u(i,"default",{value:o,enumerable:!0}),o)),v=Symbol.for("__cloudflare-request-context__");function x(){let e=globalThis[v];if("nodejs"==(process?.release?.name==="node"?"nodejs":"edge"))throw Error(m.default`
			\`getRequestContext\` and \`getOptionalRequestContext\` can only be run
			inside the edge runtime, so please make sure to have included
			\`export const runtime = 'edge'\` in all the routes using such functions
			(regardless of whether they are used directly or indirectly through imports).
		`);return e}function O(){let e=x();if(!e){if(process?.env?.NEXT_PHASE==="phase-production-build")throw Error(m.default`
				\n\`getRequestContext\` is being called at the top level of a route file, this is not supported
				for more details see https://developers.cloudflare.com/pages/framework-guides/nextjs/ssr/troubleshooting/#top-level-getrequestcontext \n
			`);throw Error("Failed to retrieve the Cloudflare request context.")}return e}},8769:()=>{},9303:(e,t,r)=>{"use strict";e.exports=r(517)},8238:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let n=Reflect.get(e,t,r);return"function"==typeof n?n.bind(e):n}static set(e,t,r,n){return Reflect.set(e,t,r,n)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},3423:(e,t,r)=>{"use strict";r.d(t,{A5:()=>s,OL:()=>a,yP:()=>i});var n=r(3358);async function a(e,t=[]){try{let{env:r}=(0,n.getRequestContext)(),a=r.DB;if(!a){console.error("DB binding not found in request context");let r=globalThis;if(r.process?.env?.DB&&"function"==typeof r.process.env.DB.prepare)return await o(r.process.env.DB,e,t);return[]}return await o(a,e,t)}catch(e){return console.error("D1 Execution Error",e),[]}}async function o(e,t,r){try{let n=e.prepare(t).bind(...r);return(await n.all()).results||[]}catch(e){throw console.error("Query Error",e),e}}async function s(){return await a("SELECT * FROM products WHERE is_active = 1 ORDER BY created_at DESC")}async function i(e){let t=`prod-${Date.now()}`,r=new Date().toISOString();return await a(`
    INSERT INTO products (id, name, description, price, car_brand, car_model, car_year, category, image_url, stock, is_active, created_at, updated_at)
    VALUES ('${t}', '${e.name}', '${e.description||""}', ${e.price}, '${e.carBrand}', '${e.carModel}', '${e.carYear||""}', '${e.category}', '${e.imageUrl||""}', ${e.stock||0}, 1, '${r}', '${r}')
  `),{...e,id:t,isActive:!0,createdAt:r,updatedAt:r}}},3895:(e,t,r)=>{"use strict";r.d(t,{Lh:()=>c,Ls:()=>s,gO:()=>i,p8:()=>u,yr:()=>o});var n=r(3423);async function a(e,t,r,a){let o=`log-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,s=new Date().toISOString();try{await (0,n.OL)(`
        INSERT INTO logs (id, type, action, data, ip, user_agent, created_at)
        VALUES ('${o}', '${e}', '${t}', '${JSON.stringify(r).replace(/'/g,"''")}', '${a?.ip||""}', '${a?.userAgent||""}', '${s}')
      `)}catch(e){console.error("Log error",e)}return{id:o,type:e,action:t,timestamp:s,data:r,ip:a?.ip,userAgent:a?.userAgent}}async function o(e){let t="SELECT * FROM logs WHERE 1=1";return e?.type&&(t+=` AND type = '${e.type}'`),e?.startDate&&(t+=` AND created_at >= '${e.startDate}'`),e?.endDate&&(t+=` AND created_at <= '${e.endDate}'`),t+=" ORDER BY created_at DESC",e?.limit&&(t+=` LIMIT ${e.limit}`),(await (0,n.OL)(t)).map(e=>({id:e.id,type:e.type,action:e.action,timestamp:e.created_at,data:JSON.parse(e.data||"{}"),ip:e.ip,userAgent:e.user_agent}))}async function s(e,t){return a("product",e,t)}async function i(e,t,r){return a("auth",e,{username:t},{ip:r})}async function c(e,t,r){return a("visitor","page_view",{page:e,productId:t},r)}async function u(e,t,r){return a("contact","inquiry",{productId:e,productName:t},r)}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,615],()=>r(8560));module.exports=n})();