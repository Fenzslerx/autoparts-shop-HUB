(()=>{var e={};e.id=435,e.ids=[435],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},1061:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>c}),t(7330),t(9101),t(6435),t(2523);var s=t(3191),r=t(8716),i=t(7922),n=t.n(i),d=t(5231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);t.d(a,l);let c=["",{children:["admin",{children:["products",{children:["[id]",{children:["edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7330)),"C:\\Users\\Field\\Desktop\\MAVARIX\\src\\app\\admin\\products\\[id]\\edit\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9101)),"C:\\Users\\Field\\Desktop\\MAVARIX\\src\\app\\admin\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,6435)),"C:\\Users\\Field\\Desktop\\MAVARIX\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,2523)),"C:\\Users\\Field\\Desktop\\MAVARIX\\src\\app\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["C:\\Users\\Field\\Desktop\\MAVARIX\\src\\app\\admin\\products\\[id]\\edit\\page.tsx"],m="/admin/products/[id]/edit/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/products/[id]/edit/page",pathname:"/admin/products/[id]/edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5513:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,9404,23)),Promise.resolve().then(t.bind(t,1074))},1746:(e,a,t)=>{Promise.resolve().then(t.bind(t,3922))},5047:(e,a,t)=>{"use strict";var s=t(7389);t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})},3922:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l,dynamic:()=>d});var s=t(326),r=t(7577),i=t(5047),n=t(4676);let d="force-dynamic";function l({params:e}){let a=(0,i.useRouter)(),t=(0,r.useRef)(null),[d,l]=(0,r.useState)(!1),[c,o]=(0,r.useState)(!0),[m,u]=(0,r.useState)(""),[x,p]=(0,r.useState)(""),[h,v]=(0,r.useState)(""),[b,y]=(0,r.useState)(""),[g,f]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[k,C]=(0,r.useState)(!1),[w,D]=(0,r.useState)([]),[P,A]=(0,r.useState)([]),[S,M]=(0,r.useState)(!1),[R,q]=(0,r.useState)(""),[_,F]=(0,r.useState)({name:"",description:"",price:"",stock:"",category:"",carModel:"",carYear:""}),E=async e=>{let a=e.target.files;if(a&&0!==a.length){M(!0);for(let e=0;e<a.length;e++){let t=a[e],s=new FileReader;s.onload=e=>{A(a=>[...a,e.target?.result])},s.readAsDataURL(t);let r=new FormData;r.append("file",t);try{let e=await fetch("/api/upload",{method:"POST",body:r}),a=await e.json();a.success&&D(e=>[...e,a.imageUrl])}catch{alert("เกิดข้อผิดพลาดในการอัปโหลด")}}M(!1)}},U=e=>{D(a=>a.filter((a,t)=>t!==e)),A(a=>a.filter((a,t)=>t!==e))},X=async e=>{e.preventDefault(),l(!0);let t=n.EK.find(e=>e.id===m),s=g?x:t?.name||"",r=j?h:_.carModel,i=k?b:_.category;try{let e=await fetch(`/api/products/${R}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({..._,price:Number(_.price),stock:Number(_.stock),carBrand:s,carModel:r,category:i,imageUrl:w[0]||"",images:w})}),t=await e.json();t.success?(alert("บันทึกเรียบร้อยแล้ว!"),a.push("/admin"),a.refresh()):alert("เกิดข้อผิดพลาด: "+t.error)}catch{alert("เกิดข้อผิดพลาด กรุณาลองใหม่")}finally{l(!1)}},z=n.EK.find(e=>e.id===m);return c?s.jsx("div",{className:"max-w-3xl mx-auto px-4 py-8 text-center",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mx-auto mb-4"}),s.jsx("div",{className:"h-64 bg-gray-100 rounded-2xl"})]})}):(0,s.jsxs)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-[var(--text-primary)]",children:"แก้ไขสินค้า"}),(0,s.jsxs)("p",{className:"text-[var(--text-secondary)] mt-1",children:["ID: ",R]})]}),(0,s.jsxs)("form",{onSubmit:X,className:"bg-white rounded-2xl border border-[var(--border)] p-6 md:p-8",children:[(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"รูปภาพสินค้า"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 mb-3",children:[P.map((e,a)=>(0,s.jsxs)("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden border-2 border-[var(--border)]",children:[s.jsx("img",{src:e,alt:`Preview ${a+1}`,className:"w-full h-full object-cover"}),s.jsx("button",{type:"button",onClick:()=>U(a),className:"absolute top-1 right-1 w-6 h-6 bg-red-500 text-white rounded-full text-xs hover:bg-red-600",children:"✕"})]},a)),s.jsx("div",{onClick:()=>t.current?.click(),className:"w-24 h-24 rounded-xl border-2 border-dashed border-[var(--border)] flex items-center justify-center cursor-pointer hover:border-[var(--primary)] transition-colors bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("span",{className:"text-2xl",children:"➕"}),s.jsx("p",{className:"text-xs text-[var(--text-muted)]",children:"เพิ่มรูป"})]})})]}),s.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,onChange:E,className:"hidden"}),S&&s.jsx("p",{className:"text-sm text-[var(--primary)]",children:"⏳ กำลังอัปโหลด..."})]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ชื่อสินค้า *"}),s.jsx("input",{type:"text",required:!0,value:_.name,onChange:e=>F({..._,name:e.target.value}),className:"input-field"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"รายละเอียด"}),s.jsx("textarea",{rows:4,value:_.description,onChange:e=>F({..._,description:e.target.value}),className:"input-field resize-none"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ราคา (บาท) *"}),s.jsx("input",{type:"number",required:!0,min:"0",value:_.price,onChange:e=>F({..._,price:e.target.value}),className:"input-field"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"จำนวนสต็อก"}),s.jsx("input",{type:"number",min:"0",value:_.stock,onChange:e=>F({..._,stock:e.target.value}),className:"input-field"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"หมวดหมู่ *"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",id:"customCategory",checked:k,onChange:e=>C(e.target.checked),className:"w-4 h-4"}),s.jsx("label",{htmlFor:"customCategory",className:"text-sm text-[var(--text-secondary)]",children:"พิมพ์หมวดหมู่เอง"})]}),k?s.jsx("input",{type:"text",required:!0,value:b,onChange:e=>y(e.target.value),className:"input-field",placeholder:"พิมพ์หมวดหมู่ใหม่..."}):(0,s.jsxs)("select",{required:!0,value:_.category,onChange:e=>F({..._,category:e.target.value}),className:"input-field",children:[s.jsx("option",{value:"",children:"เลือกหมวดหมู่"}),n.bd.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id))]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ยี่ห้อรถ *"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",id:"customBrand",checked:g,onChange:e=>{f(e.target.checked),e.target.checked&&N(!0)},className:"w-4 h-4"}),s.jsx("label",{htmlFor:"customBrand",className:"text-sm text-[var(--text-secondary)]",children:"พิมพ์ยี่ห้อเอง"})]}),g?s.jsx("input",{type:"text",required:!0,value:x,onChange:e=>p(e.target.value),className:"input-field",placeholder:"พิมพ์ยี่ห้อรถใหม่..."}):(0,s.jsxs)("select",{required:!0,className:"input-field",value:m,onChange:e=>u(e.target.value),children:[s.jsx("option",{value:"",children:"เลือกยี่ห้อ"}),n.EK.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"รุ่นรถ *"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",id:"customModel",checked:j,onChange:e=>N(e.target.checked),className:"w-4 h-4",disabled:g}),s.jsx("label",{htmlFor:"customModel",className:"text-sm text-[var(--text-secondary)]",children:"พิมพ์รุ่นเอง"})]}),j?s.jsx("input",{type:"text",required:!0,value:h,onChange:e=>v(e.target.value),className:"input-field",placeholder:"พิมพ์รุ่นรถใหม่..."}):(0,s.jsxs)("select",{required:!0,value:_.carModel,onChange:e=>F({..._,carModel:e.target.value}),className:"input-field",disabled:!m,children:[s.jsx("option",{value:"",children:"เลือกรุ่น"}),z?.models.map(e=>s.jsx("option",{value:e.name,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ปีรถ"}),s.jsx("input",{type:"text",value:_.carYear,onChange:e=>F({..._,carYear:e.target.value}),className:"input-field"})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[s.jsx("button",{type:"button",onClick:()=>a.back(),className:"px-6 py-3 rounded-xl border-2 border-[var(--border)] text-[var(--text-secondary)] hover:bg-gray-50 transition-colors",children:"ยกเลิก"}),s.jsx("button",{type:"submit",disabled:d||S,className:"flex-1 btn-primary disabled:opacity-50",children:d?"กำลังบันทึก...":"บันทึกการเปลี่ยนแปลง"})]})]})]})}},1074:(e,a,t)=>{"use strict";t.d(a,{default:()=>i});var s=t(326),r=t(5047);function i(){let e=(0,r.useRouter)(),a=async()=>{await fetch("/api/auth/logout",{method:"POST"}),e.push("/"),e.refresh()};return s.jsx("button",{onClick:a,className:"text-sm px-4 py-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 transition-colors",children:"ออกจากระบบ"})}},4676:(e,a,t)=>{"use strict";t.d(a,{EK:()=>r,bd:()=>s});let s=[{id:"engine",name:"เครื่องยนต์",icon:"⚙️",count:24},{id:"electrical",name:"ระบบไฟฟ้า",icon:"⚡",count:18},{id:"suspension",name:"ช่วงล่าง",icon:"\uD83D\uDD27",count:15},{id:"brake",name:"ระบบเบรค",icon:"\uD83D\uDED1",count:12},{id:"body",name:"ตัวถังและกระจก",icon:"\uD83D\uDE97",count:20},{id:"interior",name:"ภายในห้องโดยสาร",icon:"\uD83D\uDCBA",count:16},{id:"cooling",name:"ระบบระบายความร้อน",icon:"❄️",count:10},{id:"transmission",name:"ระบบส่งกำลัง",icon:"\uD83D\uDD29",count:8}],r=[{id:"toyota",name:"Toyota",models:[{id:"camry",name:"Camry",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"corolla",name:"Corolla Altis",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"yaris",name:"Yaris",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"hilux",name:"Hilux Revo",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"fortuner",name:"Fortuner",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"honda",name:"Honda",models:[{id:"civic",name:"Civic",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"accord",name:"Accord",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"city",name:"City",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"crv",name:"CR-V",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"hrv",name:"HR-V",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"mazda",name:"Mazda",models:[{id:"mazda2",name:"Mazda 2",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"mazda3",name:"Mazda 3",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"cx3",name:"CX-3",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"cx5",name:"CX-5",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"isuzu",name:"Isuzu",models:[{id:"dmax",name:"D-Max",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"mux",name:"MU-X",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"ford",name:"Ford",models:[{id:"ranger",name:"Ranger",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"everest",name:"Everest",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"nissan",name:"Nissan",models:[{id:"almera",name:"Almera",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"navara",name:"Navara",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"kicks",name:"Kicks",years:["2020","2021","2022","2023","2024"]}]}]},9101:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>d});var s=t(9510),r=t(7371),i=t(5456);let n=(0,t(8570).createProxy)(String.raw`C:\Users\Field\Desktop\MAVARIX\src\components\LogoutButton.tsx#default`);async function d({children:e}){let a=await (0,i.$)();return(0,s.jsxs)("div",{className:"min-h-screen bg-[var(--background)]",children:[a&&s.jsx("header",{className:"bg-white border-b border-[var(--border)] sticky top-16 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-14",children:[(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[s.jsx("span",{className:"font-semibold text-[var(--primary)]",children:"\uD83D\uDEE0️ Admin Panel"}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center gap-4",children:[s.jsx(r.default,{href:"/admin",className:"text-sm text-[var(--text-secondary)] hover:text-[var(--primary)] transition-colors",children:"Dashboard"}),s.jsx(r.default,{href:"/admin/products",className:"text-sm text-[var(--text-secondary)] hover:text-[var(--primary)] transition-colors",children:"จัดการสินค้า"}),s.jsx(r.default,{href:"/admin/logs",className:"text-sm text-[var(--text-secondary)] hover:text-[var(--primary)] transition-colors",children:"Logs"})]})]}),s.jsx(n,{})]})})}),e]})}},7330:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>i,dynamic:()=>r});var s=t(8570);let r=(0,s.createProxy)(String.raw`C:\Users\Field\Desktop\MAVARIX\src\app\admin\products\[id]\edit\page.tsx#dynamic`),i=(0,s.createProxy)(String.raw`C:\Users\Field\Desktop\MAVARIX\src\app\admin\products\[id]\edit\page.tsx#default`)},5456:(e,a,t)=>{"use strict";t.d(a,{$:()=>r});var s=t(1615);async function r(){let e=(await (0,s.cookies)()).get("admin_auth");return e?.value==="authenticated"}}};var a=require("../../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[948,990,615,111],()=>t(1061));module.exports=s})();