(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[573],{9857:function(e,a,t){Promise.resolve().then(t.bind(t,9408))},9376:function(e,a,t){"use strict";var r=t(5475);t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},9408:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return n}});var r=t(7437),s=t(2265),l=t(9376),i=t(6586);function n(){let e=(0,l.useRouter)(),a=(0,s.useRef)(null),[t,n]=(0,s.useState)(!1),[c,d]=(0,s.useState)(""),[o,m]=(0,s.useState)(""),[u,x]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[v,b]=(0,s.useState)(!1),[y,f]=(0,s.useState)(!1),[g,j]=(0,s.useState)(!1),[N,k]=(0,s.useState)([]),[C,w]=(0,s.useState)([]),[D,S]=(0,s.useState)(!1),[M,R]=(0,s.useState)({name:"",description:"",price:"",stock:"",category:"",carModel:"",carYear:""}),E=async e=>{let a=e.target.files;if(a&&0!==a.length){S(!0);for(let e=0;e<a.length;e++){let t=a[e],r=new FileReader;r.onload=e=>{w(a=>{var t;return[...a,null===(t=e.target)||void 0===t?void 0:t.result]})},r.readAsDataURL(t);let s=new FormData;s.append("file",t);try{let e=await fetch("/api/upload",{method:"POST",body:s}),a=await e.json();a.success?k(e=>[...e,a.imageUrl]):alert("อัปโหลดรูปไม่สำเร็จ")}catch(e){alert("เกิดข้อผิดพลาดในการอัปโหลด")}}S(!1)}},z=e=>{k(a=>a.filter((a,t)=>t!==e)),w(a=>a.filter((a,t)=>t!==e))},q=async a=>{a.preventDefault(),n(!0);let t=i.EK.find(e=>e.id===c),r=v?o:(null==t?void 0:t.name)||"",s=y?u:M.carModel,l=g?h:M.category;try{let a=await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...M,price:Number(M.price),stock:Number(M.stock),carBrand:r,carModel:s,category:l,imageUrl:N[0]||"",images:N})}),t=await a.json();t.success?(alert("เพิ่มสินค้าเรียบร้อยแล้ว!"),e.push("/admin"),e.refresh()):alert("เกิดข้อผิดพลาด: "+t.error)}catch(e){alert("เกิดข้อผิดพลาด กรุณาลองใหม่")}finally{n(!1)}},F=i.EK.find(e=>e.id===c);return(0,r.jsxs)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-[var(--text-primary)]",children:"เพิ่มสินค้าใหม่"}),(0,r.jsx)("p",{className:"text-[var(--text-secondary)] mt-1",children:"กรอกข้อมูลสินค้าด้านล่าง"})]}),(0,r.jsxs)("form",{onSubmit:q,className:"bg-white rounded-2xl border border-[var(--border)] p-6 md:p-8",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"รูปภาพสินค้า (เลือกได้หลายรูป)"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3 mb-3",children:[C.map((e,a)=>(0,r.jsxs)("div",{className:"relative w-24 h-24 rounded-xl overflow-hidden border-2 border-[var(--border)]",children:[(0,r.jsx)("img",{src:e,alt:"Preview ".concat(a+1),className:"w-full h-full object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>z(a),className:"absolute top-1 right-1 w-6 h-6 bg-red-500 text-white rounded-full text-xs hover:bg-red-600",children:"✕"}),N[a]&&(0,r.jsx)("div",{className:"absolute bottom-1 left-1 w-5 h-5 bg-green-500 text-white rounded-full text-xs flex items-center justify-center",children:"✓"})]},a)),(0,r.jsx)("div",{onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.click()},className:"w-24 h-24 rounded-xl border-2 border-dashed border-[var(--border)] flex items-center justify-center cursor-pointer hover:border-[var(--primary)] transition-colors bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("span",{className:"text-2xl",children:"➕"}),(0,r.jsx)("p",{className:"text-xs text-[var(--text-muted)]",children:"เพิ่มรูป"})]})})]}),(0,r.jsx)("input",{ref:a,type:"file",accept:"image/*",multiple:!0,onChange:E,className:"hidden"}),D&&(0,r.jsx)("p",{className:"text-sm text-[var(--primary)]",children:"⏳ กำลังอัปโหลด..."})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ชื่อสินค้า *"}),(0,r.jsx)("input",{type:"text",required:!0,value:M.name,onChange:e=>R({...M,name:e.target.value}),className:"input-field",placeholder:"เช่น กรองอากาศ Toyota Camry"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"รายละเอียด"}),(0,r.jsx)("textarea",{rows:4,value:M.description,onChange:e=>R({...M,description:e.target.value}),className:"input-field resize-none",placeholder:"รายละเอียดสินค้า..."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ราคา (บาท) *"}),(0,r.jsx)("input",{type:"number",required:!0,min:"0",value:M.price,onChange:e=>R({...M,price:e.target.value}),className:"input-field",placeholder:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"จำนวนสต็อก"}),(0,r.jsx)("input",{type:"number",min:"0",value:M.stock,onChange:e=>R({...M,stock:e.target.value}),className:"input-field",placeholder:"0"})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"หมวดหมู่ *"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"customCategory",checked:g,onChange:e=>j(e.target.checked),className:"w-4 h-4"}),(0,r.jsx)("label",{htmlFor:"customCategory",className:"text-sm text-[var(--text-secondary)]",children:"พิมพ์หมวดหมู่เอง"})]}),g?(0,r.jsx)("input",{type:"text",required:!0,value:h,onChange:e=>p(e.target.value),className:"input-field",placeholder:"พิมพ์หมวดหมู่ใหม่..."}):(0,r.jsxs)("select",{required:!0,value:M.category,onChange:e=>R({...M,category:e.target.value}),className:"input-field",children:[(0,r.jsx)("option",{value:"",children:"เลือกหมวดหมู่"}),i.bd.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id))]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ยี่ห้อรถ *"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"customBrand",checked:v,onChange:e=>{b(e.target.checked),e.target.checked&&f(!0)},className:"w-4 h-4"}),(0,r.jsx)("label",{htmlFor:"customBrand",className:"text-sm text-[var(--text-secondary)]",children:"พิมพ์ยี่ห้อเอง"})]}),v?(0,r.jsx)("input",{type:"text",required:!0,value:o,onChange:e=>m(e.target.value),className:"input-field",placeholder:"พิมพ์ยี่ห้อรถใหม่..."}):(0,r.jsxs)("select",{required:!0,className:"input-field",value:c,onChange:e=>d(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"เลือกยี่ห้อ"}),i.EK.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"รุ่นรถ *"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"customModel",checked:y,onChange:e=>f(e.target.checked),className:"w-4 h-4",disabled:v}),(0,r.jsx)("label",{htmlFor:"customModel",className:"text-sm text-[var(--text-secondary)]",children:"พิมพ์รุ่นเอง"})]}),y?(0,r.jsx)("input",{type:"text",required:!0,value:u,onChange:e=>x(e.target.value),className:"input-field",placeholder:"พิมพ์รุ่นรถใหม่..."}):(0,r.jsxs)("select",{required:!0,value:M.carModel,onChange:e=>R({...M,carModel:e.target.value}),className:"input-field",disabled:!c,children:[(0,r.jsx)("option",{value:"",children:"เลือกรุ่น"}),null==F?void 0:F.models.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-[var(--text-primary)] mb-2",children:"ปีรถ"}),(0,r.jsx)("input",{type:"text",value:M.carYear,onChange:e=>R({...M,carYear:e.target.value}),className:"input-field",placeholder:"เช่น 2018-2024"})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>e.back(),className:"px-6 py-3 rounded-xl border-2 border-[var(--border)] text-[var(--text-secondary)] hover:bg-gray-50 transition-colors",children:"ยกเลิก"}),(0,r.jsx)("button",{type:"submit",disabled:t||D,className:"flex-1 btn-primary disabled:opacity-50",children:t?"กำลังบันทึก...":"บันทึกสินค้า"})]})]})]})}},6586:function(e,a,t){"use strict";t.d(a,{EK:function(){return s},bd:function(){return r}});let r=[{id:"engine",name:"เครื่องยนต์",icon:"⚙️",count:24},{id:"electrical",name:"ระบบไฟฟ้า",icon:"⚡",count:18},{id:"suspension",name:"ช่วงล่าง",icon:"\uD83D\uDD27",count:15},{id:"brake",name:"ระบบเบรค",icon:"\uD83D\uDED1",count:12},{id:"body",name:"ตัวถังและกระจก",icon:"\uD83D\uDE97",count:20},{id:"interior",name:"ภายในห้องโดยสาร",icon:"\uD83D\uDCBA",count:16},{id:"cooling",name:"ระบบระบายความร้อน",icon:"❄️",count:10},{id:"transmission",name:"ระบบส่งกำลัง",icon:"\uD83D\uDD29",count:8}],s=[{id:"toyota",name:"Toyota",models:[{id:"camry",name:"Camry",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"corolla",name:"Corolla Altis",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"yaris",name:"Yaris",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"hilux",name:"Hilux Revo",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"fortuner",name:"Fortuner",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"honda",name:"Honda",models:[{id:"civic",name:"Civic",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"accord",name:"Accord",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"city",name:"City",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"crv",name:"CR-V",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"hrv",name:"HR-V",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"mazda",name:"Mazda",models:[{id:"mazda2",name:"Mazda 2",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"mazda3",name:"Mazda 3",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"cx3",name:"CX-3",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"cx5",name:"CX-5",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"isuzu",name:"Isuzu",models:[{id:"dmax",name:"D-Max",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"mux",name:"MU-X",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"ford",name:"Ford",models:[{id:"ranger",name:"Ranger",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"everest",name:"Everest",years:["2018","2019","2020","2021","2022","2023","2024"]}]},{id:"nissan",name:"Nissan",models:[{id:"almera",name:"Almera",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"navara",name:"Navara",years:["2018","2019","2020","2021","2022","2023","2024"]},{id:"kicks",name:"Kicks",years:["2020","2021","2022","2023","2024"]}]}]}},function(e){e.O(0,[971,117,744],function(){return e(e.s=9857)}),_N_E=e.O()}]);