"use strict";(()=>{var e={};e.id=684,e.ids=[684],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7016:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>$,requestAsyncStorage:()=>y,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{GET:()=>p,POST:()=>d});var n=r(3278),s=r(5002),o=r(4877),i=r(2845),c=r(6383),u=r(9057);async function p(){let e=await (0,c.A5)();return Response.json(e)}async function d(e){let t=(await (0,i.cookies)()).get("admin_auth");if(!t||"true"!==t.value)return Response.json({error:"Unauthorized"},{status:401});try{let t=await e.json(),r=await (0,c.yP)(t);return await (0,u.Ls)("create",{id:r.id,name:r.name}),Response.json(r)}catch(e){return Response.json({error:"Failed to create product"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"C:\\Users\\Field\\Desktop\\MAVARIX\\src\\app\\api\\products\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:g,serverHooks:f}=l,m="/api/products/route";function $(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},3278:(e,t,r)=>{e.exports=r(517)},4203:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let a=Reflect.get(e,t,r);return"function"==typeof a?a.bind(e):a}static set(e,t,r,a){return Reflect.set(e,t,r,a)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},6383:(e,t,r)=>{async function a(e,t=[]){try{let r=globalThis;r.process?.env?.DB;let a=process.env.DB;if(a&&"function"==typeof a.prepare){let r=a.prepare(e).bind(...t);return(await r.all()).results||[]}}catch(e){console.error("D1 Execution Error",e)}return[]}async function n(){return await a("SELECT * FROM products WHERE is_active = 1 ORDER BY created_at DESC")}async function s(e){let t=`prod-${Date.now()}`,r=new Date().toISOString();return await a(`
    INSERT INTO products (id, name, description, price, car_brand, car_model, car_year, category, image_url, stock, is_active, created_at, updated_at)
    VALUES ('${t}', '${e.name}', '${e.description||""}', ${e.price}, '${e.carBrand}', '${e.carModel}', '${e.carYear||""}', '${e.category}', '${e.imageUrl||""}', ${e.stock||0}, 1, '${r}', '${r}')
  `),{...e,id:t,isActive:!0,createdAt:r,updatedAt:r}}r.d(t,{A5:()=>n,OL:()=>a,yP:()=>s})},9057:(e,t,r)=>{r.d(t,{Lh:()=>c,Ls:()=>o,gO:()=>i,p8:()=>u,yr:()=>s});var a=r(6383);async function n(e,t,r,n){let s=`log-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,o=new Date().toISOString();try{await (0,a.OL)(`
        INSERT INTO logs (id, type, action, data, ip, user_agent, created_at)
        VALUES ('${s}', '${e}', '${t}', '${JSON.stringify(r).replace(/'/g,"''")}', '${n?.ip||""}', '${n?.userAgent||""}', '${o}')
      `)}catch(e){console.error("Log error",e)}return{id:s,type:e,action:t,timestamp:o,data:r,ip:n?.ip,userAgent:n?.userAgent}}async function s(e){let t="SELECT * FROM logs WHERE 1=1";return e?.type&&(t+=` AND type = '${e.type}'`),e?.startDate&&(t+=` AND created_at >= '${e.startDate}'`),e?.endDate&&(t+=` AND created_at <= '${e.endDate}'`),t+=" ORDER BY created_at DESC",e?.limit&&(t+=` LIMIT ${e.limit}`),(await (0,a.OL)(t)).map(e=>({id:e.id,type:e.type,action:e.action,timestamp:e.created_at,data:JSON.parse(e.data||"{}"),ip:e.ip,userAgent:e.user_agent}))}async function o(e,t){return n("product",e,t)}async function i(e,t,r){return n("auth",e,{username:t},{ip:r})}async function c(e,t,r){return n("visitor","page_view",{page:e,productId:t},r)}async function u(e,t,r){return n("contact","inquiry",{productId:e,productName:t},r)}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[379,845],()=>r(7016));module.exports=a})();